ruleset PartCAssessment

rule 272.1
	when {PartCAssessment} exists then
	require {EEM}.[EntityTypeCategory] = '2'
	else 'This component can only be submitted by an entity with an EEM entity type of ISD.'

rule 272.2 
	when {PartCAssessment} exists then
	require {EarlyOn} exist 
	else 'When this component is submitted the Early On Component must also be submitted.'
	

/* AssessmentDate rules */		
rule 272.512.1
	require {PartCAssessment}.[AssessmentDate] >= {PersonalCore}.[DateOfBirth]
	else 'The Assessment Date must be on or after the child`s date of birth.'
	
rule 272.512.2 
	require {PartCAssessment}.[AssessmentDate] <= AsOfDate
	else 'The Assessment Date must be on or before the count date for this collection.'	
	
	
/* AssessmentType rules */
rule 272.513.1
	when months since {Enrollment}.[EnrollmentDate] as of {EarlyOn}.[PartCExitDate] > 6 then
	expect {PartCAssessment}.[AssessmentType] = '03'
	else 'When the Part C Exit Date is greater than 6 months after the Enrollment Date, Assessment Type "03" (Exit) in the Part C Assessment Component is expected.'

rule 272.513.2	
	when days since {InitialIFSP}.[ReferralDate] as of AsOfDate > 90
	or days since {InitialIFSP}.[ReferralDate] as of today > 90 then
	expect {PartCAssessment}.[AssessmentType] = '01'
	else 'When the reported Referral Date in the Initial IFSP Component is more than 90 days prior to the Collection As of Date (or SRM As of Date), then an Assessment Type of "01" (Entrance) is expected.'

/* DataSource rules */		
rule 272.510.1
	when {PartCAssessment}.[DataSource] = 'F' then
	require {PartCAssessment}.[OtherSourceComments] exists
	else 'When the Data Source is "F - Other" the record must also include Other Source Comments.'
	

/* NewActions rules */		
rule 272.521.1
	when {PartCAssessment}.[AssessmentType] is in ['02','03'] then
	require {PartCAssessment}.[NewActions] exists
	else 'When reporting an annual or exit assessment for Part C New Actions must also be reported.'
	
rule 272.521.2 
	when {PartCAssessment}.[AssessmentType] = '01' then
	require {PartCAssessment}.[NewActions] does not exist
	else 'New Actions cannot be reported for an entrance assessment type.'
	

/* NewKnowledgeSkills rules */		
rule 272.519.1
	when {PartCAssessment}.[AssessmentType] is in ['02','03'] then
	require {PartCAssessment}.[NewKnowledgeSkills] exists
	else 'When reporting an annual or exit assessment for Part C New Knowledge Skills must also be reported.'
	
rule 272.519.2 
	when {PartCAssessment}.[AssessmentType] = '01' then
	require {PartCAssessment}.[NewKnowledgeSkills] does not exist
	else 'New Knowledge Skills cannot be reported for an entrance assessment type.'
	

/* NewSocialRelationships rules */		
rule 272.517.1
	when {PartCAssessment}.[AssessmentType] is in ['02','03'] then
	require {PartCAssessment}.[NewSocialRelationships] exists
	else 'When reporting an annual or exit assessment for Part C New Social Relationships must also be reported.'
	
rule 272.517.2 
	when {PartCAssessment}.[AssessmentType] = '01' then
	require {PartCAssessment}.[NewSocialRelationships] does not exist
	else 'New Social Relationships cannot be reported for an entrance assessment type.'
	

/* OtherSourceComments rules */		
rule 272.511.1
	when {PartCAssessment}.[OtherSourceComments] exists then
	require {PartCAssessment}.[DataSource] = 'F'
	else 'Other Source Comments may only be reported when the Data Source is "F - Other".'
	

/* ParentInput rules */		
rule 272.514.1
	when {PartCAssessment}.[ParentInput] = 'D' then
	require {PartCAssessment}.[ParentInputDate] does not exist
	else 'When Parent Input type contains code D, Parent Input Date cannot be reported.'
	
rule 272.514.2 
	when {PartCAssessment}.[ParentInput] is in ['A','B'] then
	require {PartCAssessment}.[ParentInputDate] exists
	else 'When Parent Input type contains code A or B, Parent Input Date must also be reported.'
	

/* ParentInputDate rules */		
rule 272.515.1
	when {PartCAssessment}.[ParentInputDate] exists then
	require {PartCAssessment}.[ParentInputDate] >= {PersonalCore}.[DateOfBirth]
	else 'The Parent Input Date must be on or after the child`s date of birth.'
	
rule 272.515.2 
	when {PartCAssessment}.[ParentInputDate] exists then
	require {PartCAssessment}.[ParentInputDate] <= AsOfDate
	else 'The Parent Input Date must be on or before the count date for this collection.'
	
rule 272.515.3
	when {PartCAssessment}.[ParentInputDate] exists
	and {PartCAssessment}.[ParentInput] = 'C' then
	require {PartCAssessment}.[ParentInputDate] = {PartCAssessment}.[AssessmentDate]
	else 'When Parent Input type contains code C and Parent Input Date is reported, it must contain the same date as Assessment Date.'


