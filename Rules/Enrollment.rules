ruleset Enrollment 

/* EnrollmentDate rules */	
rule 70.18.1 
	require {Enrollment}.[EnrollmentDate] >= {PersonalCore}.[DateOfBirth]
	else 'The Date of Enrollment cannot be earlier than the Date of Birth.'
	
rule 70.18.3
	require {Enrollment}.[EnrollmentDate] <= today
	else 'Enrollment Date must be on or prior to the current date; future dates are not allowed.'
	
rule 70.18.4
	require {Enrollment}.[EnrollmentDate] >= {EEM}.[OpenDate]
	else 'Enrollment Date must be on or after the Operating District Open Date in EEM.'
	
rule 70.18.5
	require {Enrollment}.[EnrollmentDate] <= {EEM}.[CloseDate]
	else 'The Enrollment Date must be prior to the Operating District Close Date in EEM.'
	
rule 70.18.6
	when {Enrollment}.[EnrollmentDate] <> max({EnrollmentExitDate}.[EntryDate]) then
	require {PersonalDemographics} exists
	else 'The Personal Demographics component is required when reporting a new enrollment for the student.'
	
rule 70.18.7 
	when collection is in [FallGeneralCollection,SpringGeneralCollection,EOYGeneralCollection] then
	require {Enrollment}.[EnrollmentDate] <= AsOfDate
	else 'The date reported in Enrollment Date must be on or before the count date associated with this collection.'

/* ExitDate rules */		
rule 70.22.1 
	require {Enrollment}.[DistrictExitDate] > {Enrollment}.[EnrollmentDate]
	else 'The District Exit Date must be after the Date of Enrollment.'
	
rule 70.22.4
	when {Enrollment}.[DistrictExitStatus] is not in ['01','02','03','04','05','06','40','41','42'] then
	require {Enrollment}.[DistrictExitDate] <= today
	else 'The District Exit Date cannot be a future date; only Exit Status codes 01-06 and 40-42 are allowed to report future dates within the current school year.'
	
rule 70.22.5
	when {Enrollment}.[DistrictExitStatus] is in ['01','02','03','04','05','06','40','41','42'] then
	require {Enrollment}.[DistrictExitDate] <= 31-Aug
	else 'The District Exit Date can be a future date within the current school year only.'
	
rule 70.22.6
	require {Enrollment}.[DistrictExitDate] <= {EEM}.[CloseDate]
	else 'The entity reported in Operating District was not open on the date reported in District Exit Date.'
	
rule 70.22.7 
	when collection is in [FallGeneralCollection,SpringGeneralCollection,EOYGeneralCollection] then
	require {Enrollment}.[DistrictExitDate] <= AsOfDate
	else 'The date reported in District Exit Date must be on or before the count date associated with this collection.'
	
rule 70.22.8
	when collection is EOYGeneralCollection 
	or {Enrollment}.[DistrictExitDate] exists then
	require {Attendance} exists
	or {Membership}.[StudentResidency] is in ['04','07','08','09','12','13','15']
	or {SchoolDemographics}.[GradeSetting] is in ['20','30'] 
	or {Enrollment}.[DistrictExitDate] <= 1-Sep
	or ({ProgramParticipation}.[ProgramEligibilityParticipation] = '9229' and {SpecialEducation}.[Section52FTE] = 0 and {SpecialEducation}.[Section53FTE] = 0)
	else 'Attendance component is required unless you have a Grade or Setting of 20 or 30; a Student Residency of 04, 07, 08, 09, 12, 13, or 15; a District Exit Date <= 9/1 of the current school year; or a seat-time waiver participant who is not receiving special education services for which FTE are claimed.'


/* ExitStatus rules */		
rule 70.21.1 
	when {Enrollment}.[DistrictExitStatus] = '10' then
	require {Discipline} exists
	else 'At least one Discipline component must be reported when submitting code "10" in Exit Status.'
	
rule 70.21.2 
	when {Enrollment}.[DistrictExitStatus] = '10' then
	require count({Discipline} when {Discipline}.[InitialConsequenceType] = '5') > '0'
	or count({Discipline} when {Discipline}.[SecondaryConsequenceType] = '5') > '0'
	or count({Discipline} when {Discipline}.[OtherConsequenceType] = '5') > '0'
	else 'If the District Exit Status is 10, the Consequence Type must be equal to 5 included in a Discipline component.'
	
rule 70.21.3
	when {Enrollment}.[DistrictExitStatus] = '18' then
	require {SchoolDemographics}.[GradeSetting] = '20'
	else 'If the District Exit Status is 18, the Grade or Setting must be equal to 20.'
	
rule 70.21.4
	when {Enrollment}.[DistrictExitStatus] = '21' then
	require years since {PersonalCore}.[DateOfBirth] as of 1-Sep >= '25'
	else 'If the District Exit Status is 21, the student must be 25 or older on September 1 of the current school year.'
	
rule 70.21.5
	when {Enrollment}.[DistrictExitStatus] = '30' then
	require {SchoolDemographics}.[GradeSetting] = '30'
	else 'If the District Exit Status is 30 the Grade or Setting must be equal to 30.'
	
rule 70.21.6
	when {Enrollment}.[DistrictExitStatus] is in ['40','41'] then
	require count({ProgramParticipation} when {ProgramParticipation}.[ProgramEligibilityParticipation] = '3500') > '0'
	else 'If the District Exit Status is 40 or 41, the student must be identified as participating in an Early/Middle College program.'
	
rule 70.21.7 
	when {Enrollment}.[DistrictExitStatus] is not in ['19','20'] then
	require {Enrollment}.[DistrictExitDate] exists
	else 'The reported District Exit Status requires a valid District Exit Date.'
	
rule 70.21.8
	when {Enrollment}.[DistrictExitStatus] is in ['20','21'] then
	require {SpecialEducation}.[PrimaryDisability] exists
	else 'If District Exit Status is 20 or 21, then the Special Education component is required and Primary Disability must contain a valid code.'
	
rule 70.21.9
	when {Enrollment}.[DistrictExitStatus] = '00'
	and collection is in [FallGeneralCollection,SpringGeneralCollection]then
	require {InitialIEP}.[ResultOfInitialIEP] <> '1'
	else 'If District Exit Status is 00, you may not submit code 1 in Results Of Initial IEP.'
	
rule 70.21.10
	when collection is in [FallGeneralCollection,SpringGeneralCollection,EOYGeneralCollection,TeacherStudentDataLink] 
	and {Enrollment}.[DistrictExitStatus] <> '0' then
	require {Enrollment}.[EnrollmentDate] exists
	else 'Enrollment Date is required unless District Exit Status is 00.'
	
rule 70.21.11
	when {Enrollment}.[DistrictExitStatus] = '0' then
	require {Enrollment}.[EnrollmentDate] does not exist
	else 'Enrollment Date must not be reported when Exit Status is 00.'
	
rule 70.21.12
	when {GeneralEducationFTE}.[GeneralEdFTE] <> '0'
	or {SpecialEducation}.[Section52FTE] <> '0'
	or {SpecialEducation}.[Section53FTE] <> '0' then
	require {Enrollment}.[DistrictExitStatus] = '19'
	else 'If the sum of General Ed FTE, Section 52 FTE, and Section 53 FTE is greater than 0.00, then the District Exit Status must be equal to 19.'
	
rule 70.21.13
	when {Enrollment}.[DistrictExitStatus] = '00' then
	require {Attendance} does not exist
	and {Discipline} does not exist
	and {ECSpecialEdAssessment} does not exist
	and {EarlyOn} does not exist
	and {GeneralEducationFTE} does not exist
	and {HomelessDemographics} does not exist
	and {InitialIFSP} does not exist
	and {LEP} does not exist
	and {PartBReferral} does not exist
	and {PartCAssessment} does not exist
	and {PersonalCurriculum} does not exist
	and {ProgramParticipation} does not exist
	and {SNE} does not exist
	and {SpecialEducation} does not exist
	and {TitleITAS} does not exist
	and {Section23a} does not exist
	and {Section25} does not exist
	else 'Only the SubmittingEntity, PersonalCore, SchoolDemographics, Enrollment, Membership, PersonalDemographics, StudentRecordMaintenance, and InitialIEP components may be submitted when District Exit Status is 00'
	
rule 70.21.14
	when {Enrollment}.[DistrictExitStatus] is in ['01','02','03','04','40','41','42'] then
	require {SchoolDemographics}.[GradeSetting] is in ['09','10','11','12','14','20']
	else 'Students with an exit code indicating graduation must be reported in a high school grade (9-12), special education transition (14), or adult education (20).'
	
rule 70.21.15
	when {Enrollment}.[DistrictExitStatus] is in ['01','02','03','04','05','06','07','11','40','41','42'] then
	expect years since {PersonalCore}.[DateOfBirth] as of {Enrollment}.[DistrictExitDate] >= '16'
	else 'It is unusual for a student who is less than 16 years of age to be reported with this exit status. Please confirm this student`s reported Exit Status and Date of Birth are correct.'
	
rule 70.21.16
	when {Enrollment}.[DistrictExitStatus] is in ['19','20'] then
	require {Enrollment}.[DistrictExitDate] does not exist
	else 'The District Exit Date must be blank if the District Exit Status is 19 or 00.'
	
rule 70.21.17
	when {Enrollment}.[DistrictExitStatus] is in ['01','02','03','04','40'] then
	require {Enrollment}.[DistrictExitStatus] <> '19'
	else 'Students with a Cohort Status of "graduated" cannot be reported as continuing students (District Exit Status "19").'
	
rule 70.21.18
	when {Enrollment}.[DistrictExitStatus] = '00' then
	require {InitialIEP} exists
	else 'You must submit the Initial IEP component when reporting Exit Status "00".'
	
rule 70.21.19
	when {Enrollment}.[DistrictExitStatus] = '05'
	and {SpecialEducation} does not exist then
	require {Enrollment}.[DistrictExitStatus] <> '19'
	else 'Students who are not receiving special education services, for whom the Cohort Status is "GED Completer", cannot be reported as continuing students (District Exit Status "19").'	